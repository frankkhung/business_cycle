---
title: "即時認定台灣景氣循環分析"
author: "Frank C. Hung"
date: '2023-01-16'
output:
  pdf_document:
    latex_engine: xelatex
header-includes:
  - \usepackage{fontspec}
  - \usepackage{xeCJK}    # use xeCJK package
  - \setCJKmainfont{Kaiti TC} # font for windows
mainfont: Times New Roman
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(dplyr)
library(gridExtra)
load("~/Documents/FHDocument/2022_2023/Deloitte/經濟週期/business_cycle/business_cycle.RData" )
```

# 1.、方法論

## 1-1、文獻參考依據

國家發展委員會（國發會）在景氣循環認定上因需要搜集足夠的資料、觀察夠長的時間及大量的討論，才有辦法認定經濟循環週期。因此，國發會在經濟週期發布的時間會落後實際晚上一大段時間，無法即時得知當前的景氣狀態，舉第14經濟循環週期為例，第14經濟循環週期結束時間為2016年2月，而2016年3月開始截至目前2023年1月的景氣狀態，除國發會網站上的景氣燈號外，各界皆無法得知即時的景氣狀態。

此景氣判斷方式參考下列兩文獻，使用機器學習上的學習事向量量化（Learning Vector Quantization, LVQ）的方法，並依照國發會所制定景氣循環之認定進行即時判斷2016年2月後至2020年12月之景氣狀態：

- Giusto, Andrea and Jeremy Piger (2017), 'Identifying Business Cycle Turning Points in Real Time with Vector Quantization,' International Journal of Forecasting, 33(1), 174–184.
- 朱雲榜(2021)。即時認定台灣的景氣轉折。經濟論文叢刊 (*Taiwan Economic Review*), 49:3 (2021), 335–370。

## 1-2、學習式向量化 (Learning Vector Quantization, LVQ)
雖然景氣循環為時間序列屬時間序列之範疇，但在景氣循環中，不同時間段可分為「擴張」(expansion）與「收縮」（contraction）這兩類狀態，故可以將此時間序列資料型態變成機器學習中的分類（Classification）問題。

此分析方式所使用的機器學習模型為LVQ，此方法為監督式學習中的分類方法。其概念為在各類別（擴張與收縮）的資料中，找出部分樣本（時間點）作為不同類別的代表點，再透過其餘實際訓練樣本進行調整與訓練樣本描繪出不同類別之間的邊界。此模型以已知景氣類別的時間點（樣本）作為訓練樣本進行學習，將景氣未知的時間點作為測試樣本予以預測分類，達到即時將各時間段景氣狀態進行即時分類。

更詳細的模型運作方式可參考下列兩網站：

- [https://reurl.cc/VRd8ER](https://reurl.cc/VRd8ER)
- [https://reurl.cc/MXlRZp](https://reurl.cc/MXlRZp)

# 2、景氣循環與變數

## 2-1、歷年景氣循環
```{r, echo=FALSE}
循環 <- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14)
谷底一<- c('1954.11', '1956.09', '1966.01', '1969.10', '1975.02', '1983.02', '1985.08', '1990.08', '1996.03', '1998.12', '2001.09', '2005.02', '2009.02', '2012.01')

高峰 <- c('1955.11', '1964.09', '1968.08', '1974.02', '1980.01', '1984.05', '1989.05', '1995.02', '1997.12', '2000.09', '2004.03', '2008.03', '2011.02', '2014.10')

谷底二<- c('1956.09', '1966.01', '1969.10', '1975.02', '1983.02', '1985.08', '1990.08', '1996.03', '1998.12', '2001.09', '2005.02', '2009.02', '2012.01', '2016.02')

擴張期 <- c(12, 96, 31, 52, 59, 15, 45, 54, 21, 21, 30, 37, 24, 33)
收縮期 <- c(10, 16, 14, 12, 37, 15, 15, 13, 12, 12, 11, 11, 11, 16)
全循環 <- c(22, 112, 45, 64, 96, 30, 60, 67, 33, 33, 41, 48, 35, 49)
past_cycles <- as.data.frame(cbind(循環, 谷底一, 高峰, 谷底二, 擴張期, 收縮期, 全循環))
kable(past_cycles, align = 'c')
```

## 2-2、變數選擇
景氣循環為許多經濟活動之間同步擴張或收縮的現象，反映在實際資料上，可視為不同經濟指標之間的共移 (co-movement) 現象；而 「基準循環數列」 (reference cycles series) 為刻劃景氣循環變化的指標，可用於判斷景氣循環的轉折點，通常由數項經濟指標編製而成。目前，國發會編制的基準循環數列為「實質 GDP」、「工業生產指數」、 「非農業部門就業人數」、「製造業銷售量指數」、「批發、零售及餐飲業營業額」 及 「實質海關出口值」；另外，陳淑玲與黃裕烈 (2015) 篩選大量經濟指標後，發現「工業及服務業加班工時」亦適合作為基準循環數列之構成項目。 因此，適合用於實證的變數共含上述七項經濟指標。因大部分公開資料開始蒐集時間為1982年1月，故資料期間涵蓋1982年1月至2020年12月。該期間內，工業生產指數的統計資料僅能溯自1996年1月，故此前以不含土石採取業之工業生產指數作為替代變數。再者，實質GDP為季頻資料，頻率不同於其他指數，且批發、零售及餐飲業營業額僅能取得1999年1月之資料，為讓LVQ模型有足夠資料，此分析會將實質GDP與批發、零售及餐飲業營業額變數排除。

下列為「工業生產指數」、 「非農業部門就業人數」、「製造業銷售量指數」、「實質海關出口值」及「工業及服務業加班工時」1982年1月至2020年12月個變數趨勢圖，灰底部分為第5次景氣循環後各循環之收縮期間：

```{r, echo=FALSE}
grid.arrange(ind_index$index_plot, non_agr_index$index_plot,
             export_index$index_plot, manu_index$index_plot, overtime_index$index_plot, ncol = 2)
```

## 2-2、變數處理
各變數的時間數列月資料，因受到自然氣候、風俗習慣、生產週期或假期等因素影響，往往具有季節性變化，這些季節性變化對時間數列資料會產生嚴重干擾，增加研究分析的困難。此模型使用美國普查局（Bureau of Census）發布之X-13ARIMA-SEATS季節調整工具。目前，國發會在實務上認定景氣循環或是製作景氣指標時，皆透過兩階段HP濾波（Hodrick–Prescott filter, HP Filter），藉以去除長期趨勢及平滑化，此模型亦使用此方法處理建立LVQ模型的經濟指標。下列為所使用到經濟指標之處理步驟：

1. 以X-13ARIMA-SEATS對個變數進行季節調整。 
2. 兩階段HP Filter：先以較大的平滑參數（$\lambda$ = 15426，代表月份數：70個月）進行時間序列分離出週期性的部分，因此週期性尚有不規則變動，再使用較小的平滑參數（$\lambda$ = 34，代表月份數：15個月）去除該週期不規則變動處。
3. 將各變數取差分，再進行標準化。

下列各變數的圖為變數處理後結果：

```{r, echo=FALSE}
grid.arrange(ind_index$seaadj_plot, non_agr_index$seaadj_plot,
             export_index$seaadj_plot, manu_index$seaadj_plot, overtime_index$seaadj_plot, ncol = 2)
```

下列為將五個變數合併後建LVQ模型前五個月之資料，景氣狀態1代表經濟屬於擴張期，0代表經濟屬於收縮期：

```{r, echo=FALSE}
temp <- head(all_indicator)
colnames(temp) <- c("時間點", "工業生產指數", "非農業部門就業人數",
                 "實質海關出口值", "製造業銷售量指數", "工業及服務業加班工時", "景氣狀態")
kable(temp, align = 'c', digits = 4)
```

# 3. 模型結果

## 3-1. 模型結果與國發會驗證

下表為LVQ方法對景氣循環與國發會景氣認定結果，為驗證模型預測準確性，將第9循環樣本保留為測試樣本，第9循環前為訓練樣本，檢視完準確性後再加入第9循環訓練，而第10循環進行測試，以此類推驗證至第14循環。又因為此分析為參照朱雲榜(2021)步驟所產出結果，也將該文獻中產出結果加入下表中進行與此處LVQ方法進行比較。

```{r, echo=FALSE}
循環 <- c("第10個循環：高峰", "第10個循環：谷底", "第11個循環：高峰", "第11個循環：谷底",
        "第12個循環：高峰", "第12個循環：谷底", "第13個循環：高峰", "第13個循環：谷底", 
        "第14個循環：高峰", "第14個循環：谷底")
LQV認定 <- c("2000-09", "2001-08", "2004-08","2005-04", "2008-02", "2009-03",
            "2011-02", "2012-01", "2014-10", "2016-02")
國發會認定 <- c("2000-09", "2001-09", "2004-03","2005-02", "2008-03", "2009-02",
            "2011-03", "2011-11", "2015-01", "2015-12")
與國發會差距 <- c("0", "+1", "-5", "-2", "-1", "-1", "-1", "+2", "-3", "+2")

文獻認定 <- c("2000-08", "2001-08", "2004-06","2005-03", "2007-12", "2009-03",
            "2011-02", "2012-01", "2015-01", "2015-12")

與文獻差距 <- c("+1", "0", "-2", "-1", "+2", "0", "-1", "+2", "0", "0")
results <- as.data.frame(cbind(循環, LQV認定, 國發會認定, 與國發會差距, 文獻認定, 與文獻差距))
kable(results, align = 'c')
```

## 3-2. IRB樣本期間景氣狀態
目前IRB專案樣本期間為2015年1月至2020年6月，而因2016年2月國發會認定第14個景氣循環結束後，2016年2月開始景氣狀態無從得知，故可以使用此LVQ方法進行預測第15個景氣循環。

因朱雲榜(2021)假設國發會認定的低谷或高峰會持續6個月，所以1982年2月至2016年8月為訓練樣本，2016年9月開始為測試樣本。循環的判斷標準可以參考*[國發會台灣景氣循環簡介](https://www.ndc.gov.tw/cp.aspx?n=BD9B4A61760FEA3D&s=BECE55D86CE6B99C)*。預測結果為第15個循環高峰於2018年9月出現，第15個循環低谷於2019年4月出現，可證明IRB專案樣本期間**2015年1月至2020年6月**有包含一個景氣循環。下表為2015年1月至2020年6月各月景氣判斷結果。

```{r, echo=FALSE}
temp <- cycle15_predict %>% select(date, ind_change_std, non_agr_change_std, export_change_std, manu_change_std,
                                   overtime_change_std, predict_indicator)
colnames(temp) <- c("時間點", "工業生產指數", "非農業部門就業人數",
                 "實質海關出口值", "製造業銷售量指數", "工業及服務業加班工時", "景氣預測（1:擴張，0:收縮）")
kable(temp, align = 'c', digits = 4)
```

# 參考文獻
- 朱雲榜(2021)。即時認定台灣的景氣轉折。經濟論文叢刊 (*Taiwan Economic Review*), 49:3 (2021), 335–370。
- Giusto, Andrea and Jeremy Piger (2017), 'Identifying Business Cycle Turning Points in Real Time with Vector Quantization,' International Journal of Forecasting, 33(1), 174–184.